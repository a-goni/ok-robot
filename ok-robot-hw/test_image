# This code is purely to test the image on the robot. To test the dimensions and ensure that the code works to capture it.

import cv2
import base64
import matplotlib.pyplot as plt
from camera import RealSenseCamera
from robot import HelloRobot

# Function to capture an image and encode it to base64
def capture_and_encode_image(camera):
    rgb_image, _, _ = camera.capture_image()

    # Rotate the image 90 degrees to the right
    rgb_image = cv2.rotate(rgb_image, cv2.ROTATE_90_CLOCKWISE)

    # Get the dimensions of the image
    height, width, channels = rgb_image.shape
    print(f"Image Dimensions: {width}x{height}x{channels} (Width x Height x Channels)")

    # Display the captured image
    plt.figure(figsize=(10, 10))
    plt.imshow(rgb_image)
    plt.title("Captured Image")
    plt.axis('off')
    plt.show()

    _, buffer = cv2.imencode('.jpg', rgb_image)
    encoded_image = base64.b64encode(buffer).decode('utf-8')
    return encoded_image

# Script
hello_robot = HelloRobot()
camera = RealSenseCamera(hello_robot.robot)

encoded_img = capture_and_encode_image(camera)